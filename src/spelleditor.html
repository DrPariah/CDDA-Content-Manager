<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Cataclysm: Dark Days Ahead content manager</title>
		<link rel="stylesheet" href="index.css">
	</head>
	 <script src="filesystemfunctions.js"></script>
	 <script src="commonfunctions.js"></script> 
	 <script src="jsonfunctions.js"></script> 
	 <script src="commonclasses.js"></script> 
	 <script src="constants.js"></script> 
	 <script src="htmlfunctions.js"></script> 
	<script>
		const formJSONFile = "spell_editform.json";
		var entryList;
		
		//When the page finishes loading
		document.addEventListener("DOMContentLoaded", function(event) {
			init();
		});
		
		
		//Initialize function, it is asynchonous to allow await-ing for the functions called in init.
		async function init(){
			entryList = new jsonObjList(document.getElementById("entryList"), DATA_MODS, "id", [["type", "SPELL", true, true]]);
		}
		
		
		
		
		//When the user selects an item from the spell list
		async function entryList_change(selectElement){
			//User selects an item
			let item = selectElement.options[selectElement.selectedIndex];
			if(!item){return;}
			//Get item title (it's a json string)
			let itemTitle = item.title;
			//Transform the title string to a json object
			var jsonObj = JSON.parse(itemTitle);  
			//Transform the json object to html
			let htmlString = await buildHtmlEditFormFromJSON_andFile(jsonObj);
			entryList.selectedEntryId = item.value;
		}
		
	</script> 
		<body>
		<h1>Cataclysm: Dark Days Ahead spell editor</h1>
		<p>Welcome to the content manager of Cataclysm: Dark Days Ahead. <a href="index.html">back to home</a></p>
		<div class="mainContent">
		<table>
		<tr>
			<td>
				<p>List of spells:</p>
				<p id="listspellsContainer">
					<select name="entryList" id="entryList"  onchange="entryList_change(this);" size="41">
					</select>
				</p>
			</td>
			<td>
				<div class="contentContainer">
					<p id="editForm">Select a spell to start.</p>
				</div>
			</td>
		</tr>
		</div>
		</table>
		
		
	</body>
</html>
